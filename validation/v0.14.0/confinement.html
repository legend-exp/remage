<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="HPGe detector distance to surface" href="distances.html" /><link rel="prev" title="Double-beta decay physics" href="bxdecay0.html" />
        <link rel="prefetch" href="_static/remage-logo.png" as="image" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.07.19 -->
        <title>Vertex confinement - remage 0.14.0 validation suite</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>

<div class="announcement">
  <aside class="announcement-content">
     <em>Work in progress:</em> we are currently populating the validation report, come back at a later point! 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">remage 0.14.0 validation suite</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/remage-logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">remage 0.14.0 validation suite</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="versioninfo.html">About this validation report</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Sections</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="bxdecay0.html">Double-beta decay physics</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Vertex confinement</a></li>
<li class="toctree-l1"><a class="reference internal" href="distances.html">HPGe detector distance to surface</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist.html">Comparison with NIST</a></li>
<li class="toctree-l1"><a class="reference internal" href="observables-ge.html">HPGe tracking and observables</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://remage.readthedocs.io">remage documentation</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/legend-exp/remage/blob/main/docs/validation/confinement.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/legend-exp/remage/edit/main/docs/validation/confinement.md" rel="edit" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          
<style>
  .ss-layout-default-AB { grid-template-areas: 'A B'; }
  .ss-layout-default-ABC { grid-template-areas: 'A B C'; }
  .ss-layout-default-AB_CD_EF { grid-template-areas: 'A B' 'C D' 'E F'; }
</style>
<section class="tex2jax_ignore mathjax_ignore" id="vertex-confinement">
<h1>Vertex confinement<a class="headerlink" href="#vertex-confinement" title="Link to this heading">¶</a></h1>
<p>This section of the validation suite describes the generation of primary event
vertices and their confinement within a particular geometrical or physical
volume.</p>
<p>These tests consist both of Geant4 visualisation plots showing the location of
generated primaries as well as some statistical tests.</p>
<section id="natively-sampleable-solids">
<h2>Natively sampleable solids<a class="headerlink" href="#natively-sampleable-solids" title="Link to this heading">¶</a></h2>
<p>The first set of tests are related to sampling on the bulk or the surface of
simple solids, these can be sampled natively (i.e. without rejection sampling).</p>
<figure class="sphinx-subfigure align-default" id="id1">
<div class="sphinx-subfigure-grid ss-layout-default-AB" style="display: grid;">
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: A;">
<span class="caption">Vertices sampled in the bulk of solids.</span>
<a class="reference internal image-reference" href="_images/native-volume.output.jpeg"><img alt="Vertices sampled in the bulk of solids." src="_images/native-volume.output.jpeg" style="height: 400px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: B;">
<span class="caption">Vertices sampled on the surface of solids.</span>
<a class="reference internal image-reference" href="_images/native-surface.output.jpeg"><img alt="Vertices sampled on the surface of solids." src="_images/native-surface.output.jpeg" style="height: 400px;" />
</a>
</div>
</div>
<figcaption>
<p><span class="caption-text">Vertices sampled in simple solids.</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p> </p>
<p>You should see that the primaries are generated in the cylinder (far left), box
(front center), orb (back and center) and also for the bulk simulation in the
sphere section (front). It should also be possible to appreciate an apparent
higher density of points for the surface simulation.</p>
</section>
<section id="complex-solids">
<h2>Complex solids<a class="headerlink" href="#complex-solids" title="Link to this heading">¶</a></h2>
<p>The next tests relate to generation of points on complex solids, generated from
intersections and unions. Similar to the previous test simulations are performed
both for the surface and the bulk.</p>
<figure class="sphinx-subfigure align-default" id="id2">
<div class="sphinx-subfigure-grid ss-layout-default-AB" style="display: grid;">
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: A;">
<span class="caption">Vertices sampled in the bulk of solids.</span>
<a class="reference internal image-reference" href="_images/complex-volume.output.jpeg"><img alt="Vertices sampled in the bulk of solids." src="_images/complex-volume.output.jpeg" style="height: 400px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: B;">
<span class="caption">Vertices sampled on the surface of solids.</span>
<a class="reference internal image-reference" href="_images/complex-surface.output.jpeg"><img alt="Vertices sampled on the surface of solids." src="_images/complex-surface.output.jpeg" style="height: 400px;" />
</a>
</div>
</div>
<figcaption>
<p><span class="caption-text">Vertices sample in complex solids.</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p> </p>
<p>You should see points generated on the polycone (back left), in a box with a
center cut out (directly in front of the polycone), in a solid formed of the
intersection of a box and sphere (back right). You should also see points
generated in the sphere with a box inside (front right). Again you should be
able to appreciate a higher density of points on the surface in the surface
simulation.</p>
</section>
<section id="unions-and-intersections">
<h2>Unions and intersections<a class="headerlink" href="#unions-and-intersections" title="Link to this heading">¶</a></h2>
<p>remage also has the possibility to generate primaries in a geometrical volume,
i.e. a user defined shape not necessarily corresponding to any physical volume
in the detector. In addition, there is the possibility to select vertices just
in the intersection of a physical and geometrical volume or in the union of some
physical and geometrical volumes. This subsection validates these features.</p>
<figure class="sphinx-subfigure align-default" id="id3">
<div class="sphinx-subfigure-grid ss-layout-default-ABC" style="display: grid;">
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: A;">
<span class="caption">Geometrical (user defined) volumes.</span>
<a class="reference internal image-reference" href="_images/geometrical.output.jpeg"><img alt="Geometrical (user defined) volumes." src="_images/geometrical.output.jpeg" style="height: 200px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: B;">
<span class="caption">Geometrical (user defined) or physical volumes.</span>
<a class="reference internal image-reference" href="_images/geometrical-or-physical.output.jpeg"><img alt="Geometrical (user defined) or physical volumes." src="_images/geometrical-or-physical.output.jpeg" style="height: 200px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: C;">
<span class="caption">Intersection of geometrical and physical volumes.</span>
<a class="reference internal image-reference" href="_images/geometrical-and-physical.output.jpeg"><img alt="Intersection of geometrical and physical volumes." src="_images/geometrical-and-physical.output.jpeg" style="height: 200px;" />
</a>
</div>
</div>
<figcaption>
<p><span class="caption-text">Checks on sampling for intersections and unions.</span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>In the first case, you should see points sampled in three user defined
volumes, a section of a cylinder (far left), a box (center back) and a sphere
(center front - overlapping with a box).</p></li>
<li><p>In the second plot, the primaries are generated eithert in the sphere (from
the previous section), or a box (back right), or the small section of a
cylinder (front center).</p></li>
<li><p>Finally in the last case primaries should be generated in the intersection of
the sphere (front right) with a user defined smaller sphere.</p></li>
</ul>
</section>
<section id="generic-surface-sampling">
<h2>Generic surface sampling<a class="headerlink" href="#generic-surface-sampling" title="Link to this heading">¶</a></h2>
<p><em>remage</em> has a dedicated algorithm for sampling points on the surface of any
solid. The next section of the validation report provides tests on the
intermediate steps of this algorithm and on the final result.</p>
<section id="bounding-sphere">
<h3>Bounding sphere<a class="headerlink" href="#bounding-sphere" title="Link to this heading">¶</a></h3>
<p>The surface sampling algorithm requires a bounding sphere containing the solid.
Points are then generated outside this bounding sphere, and based on a random
direction the number of intersections is computed.</p>
<p>The following figures show the bounding sphere and initial points (which should
be outside the bounding sphere). You should see that the grey bounding spheres
are large enough to contain the green solids and that the red points all lie
outside the grey box.</p>
<figure class="sphinx-subfigure align-default" id="id4">
<div class="sphinx-subfigure-grid ss-layout-default-ABC" style="display: grid;">
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: A;">
<span class="caption">Bounding sphere for cylinder.</span>
<a class="reference internal image-reference" href="_images/surface-sample-bounding-box-simple.output.jpeg"><img alt="Bounding sphere for cylinder." src="_images/surface-sample-bounding-box-simple.output.jpeg" style="width: 200px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: B;">
<span class="caption">Bounding sphere for subtraction.</span>
<a class="reference internal image-reference" href="_images/surface-sample-bounding-box-subtraction.output.jpeg"><img alt="Bounding sphere for subtraction." src="_images/surface-sample-bounding-box-subtraction.output.jpeg" style="width: 200px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: C;">
<span class="caption">Bounding sphere for union.</span>
<a class="reference internal image-reference" href="_images/surface-sample-bounding-box-union.output.jpeg"><img alt="Bounding sphere for union." src="_images/surface-sample-bounding-box-union.output.jpeg" style="width: 200px;" />
</a>
</div>
</div>
<figcaption>
<p><span class="caption-text">Checks on the bounding spheres.</span><a class="headerlink" href="#id4" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="location-of-sampled-vertices">
<h3>Location of sampled vertices<a class="headerlink" href="#location-of-sampled-vertices" title="Link to this heading">¶</a></h3>
<p>The next figures show the location of generated primaries for various different
solids. You should see the primaries are contained in the appropriate solid and
that they are distributed on the surface.</p>
<figure class="sphinx-subfigure align-default" id="id5">
<div class="sphinx-subfigure-grid ss-layout-default-AB_CD_EF" style="display: grid;">
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: A;">
<span class="caption">Sampled on a cylinder (shown in light pink).</span>
<a class="reference internal image-reference" href="_images/vis-surface-tubby.output.jpeg"><img alt="Sampled on a cylinder (shown in light pink)." src="_images/vis-surface-tubby.output.jpeg" style="width: 300px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: B;">
<span class="caption">Sampled on a box (shown in green).</span>
<a class="reference internal image-reference" href="_images/vis-surface-box.output.jpeg"><img alt="Sampled on a box (shown in green)." src="_images/vis-surface-box.output.jpeg" style="width: 300px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: C;">
<span class="caption">Sampled on a trapezoid (shown in purple).</span>
<a class="reference internal image-reference" href="_images/vis-surface-trd.output.jpeg"><img alt="Sampled on a trapezoid (shown in purple)." src="_images/vis-surface-trd.output.jpeg" style="width: 300px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: D;">
<span class="caption">Sampled on the union of two boxes (shown in red).</span>
<a class="reference internal image-reference" href="_images/vis-surface-uni.output.jpeg"><img alt="Sampled on the union of two boxes (shown in red)." src="_images/vis-surface-uni.output.jpeg" style="width: 300px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: E;">
<span class="caption">Sampled on the subtraction of two cylinders (shown in dark pink).</span>
<a class="reference internal image-reference" href="_images/vis-surface-sub.output.jpeg"><img alt="Sampled on the subtraction of two cylinders (shown in dark pink)." src="_images/vis-surface-sub.output.jpeg" style="width: 300px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: F;">
<span class="caption">Sampled vertices on a cone (shown in dark blue).</span>
<a class="reference internal image-reference" href="_images/vis-surface-con.output.jpeg"><img alt="Sampled vertices on a cone (shown in dark blue)." src="_images/vis-surface-con.output.jpeg" style="width: 300px;" />
</a>
</div>
</div>
<figcaption>
<p><span class="caption-text">Checks on the location of vertices for surface sampling.</span><a class="headerlink" href="#id5" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="statistical-tests-of-uniformity">
<h3>Statistical tests of uniformity<a class="headerlink" href="#statistical-tests-of-uniformity" title="Link to this heading">¶</a></h3>
<p>The final part of the test for the generic surface sampler is a series of
statistical tests on the uniformity of the points on the surface of the shapes.
This is based on counting the number of primaries on each face of the solids and
comparing the ratio to that of the surface areas. The tests are based on the
same simulation as in the previous section.</p>
<p>First we plot the 3D position of the vertices labelling which side the vertex is
closest too by color. If a vertex is not close to any side the test will fail.</p>
<figure class="sphinx-subfigure align-default">
<div class="sphinx-subfigure-grid ss-layout-default-AB_CD_EF" style="display: grid;">
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: A;">
<a class="reference internal image-reference" href="_images/confinement.simple-solids-surface-tubby-3d.output.png"><img alt="_images/confinement.simple-solids-surface-tubby-3d.output.png" src="_images/confinement.simple-solids-surface-tubby-3d.output.png" style="width: 400px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: B;">
<a class="reference internal image-reference" href="_images/confinement.simple-solids-surface-box-3d.output.png"><img alt="_images/confinement.simple-solids-surface-box-3d.output.png" src="_images/confinement.simple-solids-surface-box-3d.output.png" style="width: 400px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: C;">
<a class="reference internal image-reference" href="_images/confinement.simple-solids-surface-trd-3d.output.png"><img alt="_images/confinement.simple-solids-surface-trd-3d.output.png" src="_images/confinement.simple-solids-surface-trd-3d.output.png" style="width: 400px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: D;">
<a class="reference internal image-reference" href="_images/confinement.simple-solids-surface-uni-3d.output.png"><img alt="_images/confinement.simple-solids-surface-uni-3d.output.png" src="_images/confinement.simple-solids-surface-uni-3d.output.png" style="width: 400px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: E;">
<a class="reference internal image-reference" href="_images/confinement.simple-solids-surface-sub-3d.output.png"><img alt="_images/confinement.simple-solids-surface-sub-3d.output.png" src="_images/confinement.simple-solids-surface-sub-3d.output.png" style="width: 400px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: F;">
<a class="reference internal image-reference" href="_images/confinement.simple-solids-surface-con-3d.output.png"><img alt="_images/confinement.simple-solids-surface-con-3d.output.png" src="_images/confinement.simple-solids-surface-con-3d.output.png" style="width: 400px;" />
</a>
</div>
</div>
</figure>
<p>You should be able to verify that the primaries close to each surface are
correctly identified and that the primaries are indeed distributed on a surface.</p>
<p>Finally, we perform the statistical tests comparing the ratio of primaries on
each surface to the ratio of surface area. You should see only statistical
fluctuations.</p>
<figure class="sphinx-subfigure align-default">
<div class="sphinx-subfigure-grid ss-layout-default-AB_CD_EF" style="display: grid;">
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: A;">
<a class="reference internal image-reference" href="_images/confinement.simple-solids-surface-tubby-ratios.output.png"><img alt="_images/confinement.simple-solids-surface-tubby-ratios.output.png" src="_images/confinement.simple-solids-surface-tubby-ratios.output.png" style="width: 400px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: B;">
<a class="reference internal image-reference" href="_images/confinement.simple-solids-surface-box-ratios.output.png"><img alt="_images/confinement.simple-solids-surface-box-ratios.output.png" src="_images/confinement.simple-solids-surface-box-ratios.output.png" style="width: 400px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: C;">
<a class="reference internal image-reference" href="_images/confinement.simple-solids-surface-trd-ratios.output.png"><img alt="_images/confinement.simple-solids-surface-trd-ratios.output.png" src="_images/confinement.simple-solids-surface-trd-ratios.output.png" style="width: 400px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: D;">
<a class="reference internal image-reference" href="_images/confinement.simple-solids-surface-uni-ratios.output.png"><img alt="_images/confinement.simple-solids-surface-uni-ratios.output.png" src="_images/confinement.simple-solids-surface-uni-ratios.output.png" style="width: 400px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: E;">
<a class="reference internal image-reference" href="_images/confinement.simple-solids-surface-sub-ratios.output.png"><img alt="_images/confinement.simple-solids-surface-sub-ratios.output.png" src="_images/confinement.simple-solids-surface-sub-ratios.output.png" style="width: 400px;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: F;">
<a class="reference internal image-reference" href="_images/confinement.simple-solids-surface-con-ratios.output.png"><img alt="_images/confinement.simple-solids-surface-con-ratios.output.png" src="_images/confinement.simple-solids-surface-con-ratios.output.png" style="width: 400px;" />
</a>
</div>
</div>
</figure>
</section>
</section>
<section id="dedicated-simulations-for-ge-in-lar">
<h2>Dedicated simulations for Ge in LAr<a class="headerlink" href="#dedicated-simulations-for-ge-in-lar" title="Link to this heading">¶</a></h2>
<p>The last sub-section of this part of the validation report contains a more
specific test with an array of HPGe detectors emersed in LAr. The geometry is
shown below, showing the HPGe detectors (blue) in the red LAr cylinder.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/vis-ge-array.output.jpeg"><img alt="Geant4 visualisation of a HPGe array in LAr." src="_images/vis-ge-array.output.jpeg" style="width: 400px;" />
</a>
</figure>
<section id="relative-fraction-of-events-per-hpge-volume">
<h3>Relative fraction of events per HPGe volume<a class="headerlink" href="#relative-fraction-of-events-per-hpge-volume" title="Link to this heading">¶</a></h3>
<p>The first test consists of generating events uniformly across all the HPGe
detectors and checking that the fraction of primaries in each volume matches the
ratio of the volumes.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/relative-ge.output.png"><img alt="_images/relative-ge.output.png" src="_images/relative-ge.output.png" style="width: 700px;" />
</a>
</figure>
</section>
<section id="generation-in-parts-of-the-lar-volume">
<h3>Generation in parts of the LAr volume<a class="headerlink" href="#generation-in-parts-of-the-lar-volume" title="Link to this heading">¶</a></h3>
<p>We generate events in intersection of the LAr volume surrounding the detectors
and a cylinder around each detector string. We plot a histogram of the positions
of the primaries which should show gaps due to the HPGe detectors. And we
compute the ratio of primaries in each cylinder, which should be proportional to
the volume of the cylinder minus that of the Germanium.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/lar-in-check-xy.output.png"><img alt="_images/lar-in-check-xy.output.png" src="_images/lar-in-check-xy.output.png" style="width: 700px;" />
</a>
</figure>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/lar-in-check-xz.output.png"><img alt="_images/lar-in-check-xz.output.png" src="_images/lar-in-check-xz.output.png" style="width: 700px;" />
</a>
</figure>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/lar-in-check-ratios.output.png"><img alt="_images/lar-in-check-ratios.output.png" src="_images/lar-in-check-ratios.output.png" style="width: 700px;" />
</a>
</figure>
<p>Finally, we generate primaries in the subtraction of the LAr region and the
cylinders around each string.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/lar-sub-check-xy.output.png"><img alt="_images/lar-sub-check-xy.output.png" src="_images/lar-sub-check-xy.output.png" style="width: 700px;" />
</a>
</figure>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/lar-sub-check-xz.output.png"><img alt="_images/lar-sub-check-xz.output.png" src="_images/lar-sub-check-xz.output.png" style="width: 700px;" />
</a>
</figure>
<p>Then also with an intersection of another cylinder with the height of the
strings.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/lar-int-and-sub-check-xy.output.png"><img alt="_images/lar-int-and-sub-check-xy.output.png" src="_images/lar-int-and-sub-check-xy.output.png" style="width: 700px;" />
</a>
</figure>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/lar-int-and-sub-check-xz.output.png"><img alt="_images/lar-int-and-sub-check-xz.output.png" src="_images/lar-int-and-sub-check-xz.output.png" style="width: 700px;" />
</a>
</figure>
<p> </p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="distances.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">HPGe detector distance to surface</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="bxdecay0.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Double-beta decay physics</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2020, the LEGEND Collaboration
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Vertex confinement</a><ul>
<li><a class="reference internal" href="#natively-sampleable-solids">Natively sampleable solids</a></li>
<li><a class="reference internal" href="#complex-solids">Complex solids</a></li>
<li><a class="reference internal" href="#unions-and-intersections">Unions and intersections</a></li>
<li><a class="reference internal" href="#generic-surface-sampling">Generic surface sampling</a><ul>
<li><a class="reference internal" href="#bounding-sphere">Bounding sphere</a></li>
<li><a class="reference internal" href="#location-of-sampled-vertices">Location of sampled vertices</a></li>
<li><a class="reference internal" href="#statistical-tests-of-uniformity">Statistical tests of uniformity</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dedicated-simulations-for-ge-in-lar">Dedicated simulations for Ge in LAr</a><ul>
<li><a class="reference internal" href="#relative-fraction-of-events-per-hpge-volume">Relative fraction of events per HPGe volume</a></li>
<li><a class="reference internal" href="#generation-in-parts-of-the-lar-volume">Generation in parts of the LAr volume</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/tabs.js?v=3ee01567"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    </body>
</html>